CREATE DATABASE IF NOT EXISTS bank_db;
USE bank_db;

-- ACCOUNTS
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (
  acc_no INT PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  balance DECIMAL(12,2) NOT NULL DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- TRANSACTIONS
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (
  id INT AUTO_INCREMENT PRIMARY KEY,
  acc_no INT NOT NULL,
  type VARCHAR(30) NOT NULL,
  amount DECIMAL(12,2) NOT NULL DEFAULT 0,
  before_balance DECIMAL(12,2) NOT NULL DEFAULT 0,
  after_balance DECIMAL(12,2) NOT NULL DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- LOCKERS
DROP TABLE IF EXISTS lockers;
CREATE TABLE lockers (
  id INT AUTO_INCREMENT PRIMARY KEY,
  acc_no INT NOT NULL UNIQUE,
  locker_key VARCHAR(80) NOT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- REQUESTS
DROP TABLE IF EXISTS requests;
CREATE TABLE requests (
  id INT AUTO_INCREMENT PRIMARY KEY,
  acc_no INT NULL,
  request_type VARCHAR(40) NOT NULL,
  payload TEXT NULL,                     -- IMPORTANT FIX (TEXT)
  status VARCHAR(20) NOT NULL DEFAULT 'PENDING',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
