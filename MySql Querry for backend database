USE bank_db;

ALTER TABLE transactions
DROP FOREIGN KEY transactions_ibfk_1;

ALTER TABLE transactions
ADD CONSTRAINT transactions_ibfk_1
FOREIGN KEY (acc_no) REFERENCES accounts(acc_no)
ON DELETE CASCADE
ON UPDATE CASCADE;

CREATE TABLE IF NOT EXISTS lockers (
  id INT AUTO_INCREMENT PRIMARY KEY,
  acc_no INT NOT NULL UNIQUE,
  locker_key VARCHAR(40) NOT NULL UNIQUE,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (acc_no) REFERENCES accounts(acc_no)
  ON DELETE CASCADE
  ON UPDATE CASCADE
);
